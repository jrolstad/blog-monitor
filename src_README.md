# Blog Monitor
The components in Blog Monitor poll subscribed blogs and notify when a new post is detected. Components are primarily written in Golang and use AWS resources for processing, data storage, and notification capabilities.

# Requirements
* golang 1.21 or higher

# Components
## Applications

|Name|Location|Purpose|
|---|---|---|
|Command Line Interface|cmd/cli|Command line tool that performs the polling of blog data|
|Cron Monitor|cmd/lambda/cron_monitor|Lambda function that runs on an hourly basis and performs the polling of blog data|

## Libraries

|Name|Location|Purpose|
|---|---|---|
|clients|internal/clients|Implementations around interacting with different directory providers and other external APIs / services|
|configuration|internal/config|Reads configuration data|
|logging|internal/logging|Wrapper around logging code to ensure all items are logged the same|
|models|internal/models|Data models / structs used in the components|
|orchestration|internal/orchestration|The main entry point for all exposed functionality. Contains business logic, processing, and flow implementations|
|repositories|internal/repositories|Data repositories used to read and update application data|

# Infrastructure
The infrastructure used to implement this solution is defined with Terraform HCL.  See the [deployments/infra](deployments/infra/) directory for more details.

A sample deployment pipelien for this can be seen at [infra-deploy-prd](.github/workflows/deploy-prd.yml)

# Pipelines
The following pipelines are used by this repository to build, test, and deploy a sample instance.  They are:
|Name|Location|Purpose|
|---|---|---|
|application-continuous-integration|[.github/workflows/application-ci.yml](.github/workflows/application-ci.yml)|Application code (golang) CI build|
|terraform-continuous-integration|[.github/workflows/terraform-ci.yml](.github/workflows//terraform-ci.yml)|Infrastructure code (terraform) CI Build|
|infra-deploy-prd|[.github/workflows/infra-deploy-prd.yml](.github/workflows/infra-deploy-prd.yml)|Sample deployment pipeline to an AWS Account|

# How to Use
To start using Blog Monitor, use the following steps

## 1. Create Cloud Resources
Using the infrastructure defined via HCL code in the [deployments/infra](deployments/infra/) folder, run this on an AWS Account that you own so the resources are properly configured

## 2. Configure Local AWS Credentials
Once the AWS resources are configured, credentials on the machine that will be running the console app need to be configured.  In your machine's environment variables, ensure there are valid AWS credentials for the Account where the resources created in step 1 are located.

### Example
```
export aws_region=us-west-2
export AWS_ACCESS_KEY_ID=AKIAGDBMSF5KR367TZX
export AWS_SECRET_ACCESS_KEY=somesupersecretvalue
```

## 3. Configure Environment Variables
Additional variables to configure for the application to run locally are below.  Values are for illusstrative purposes only; be sure they match what you have set up in previous steps.

|Name|Description|Example Value|
|---|---|---|
|email_sender|Which email address to send the notifications from|name@mail.com|                   
|subscription_table_name|Name of the DynamoDb table that contains subscription information|blogmonitor_subscription_dev|         
|notification_history_table_name|Name of the DynamoDb table that contains execution history information|blogmonitor_notification_history_dev|   
|secret_google_api_key|API Key use to authenticate to Google Blogger APIs. Generated by adding the Blogger API to a Google Cloud Platform (GCP) Project at https://console.cloud.google.com/apis/dashboard|Axsfasdfadr|           

## 4. Execute Command Line Application
When the AWS resources are setup and credentials set locally, the command line app can be executed.  This app performs the same as the Lambda function where it reads all subscriptions and sends notifications for new posts.

In the cmd/cli directory, below are examples of commands to run to read directory data.

```
go run main.go
```

# Development Environment Setup
To set up your development environment, follow the steps above in the _How to Use_ section.
Once complete, you should be able to open this solution in an editor of your choice and start making changes / running on your own.
